if (!requireNamespace("tidyverse", quietly = TRUE)){
install.packages("tidyverse")
}
library(tidyverse)
library(broom)
# set to 33
set.seed(33)
# fill in the missing parameters at ___
# simulate the the normal distribution wie set to sample size 30
help(rnorm)
my_data <- tibble(x1 = rnorm(30),
x2 = rnorm(30),
x3_noise = rnorm(30),
x4_noise = rnorm(30),
x5_noise = rnorm(30),
error = rnorm(30, sd = 3))
# Simulate data y with underlying population parameter \beta = (3, 1)
my_data <- my_data %>% mutate(y = x1*3 + x2*1 + error)
# Regress y on x1 and x2, without intercept
lm_small <- lm(y ~ x1 + x2 - 1, data = my_data)
# Have a look at the coefficients and summary statistics of the small model
lm_small %>% tidy()   # same as tidy(lm_small)
lm_small %>% glance() # same as glance(lm_small)
# Regress y on x1 and x2 and the noise variables, without intercept
lm_big <- lm(y ~ ___ + ___ + ___ + ___ + ___ - ___, data = my_data)
# Have a look at the coefficients and summary statistics of the small model
lm_big %>% tidy()
lm_big %>% glance()
lm_big <- lm(y ~ x1 + x2 + x3_noise + x4_noise + x5_noise - 1, data = my_data)
# Have a look at the coefficients and summary statistics of the small model
lm_big %>% tidy()
lm_big %>% glance()
if (!requireNamespace("tidyverse", quietly = TRUE)){
install.packages("tidyverse")
}
library(tidyverse)
library(broom)
# set to 33
set.seed(33)
# fill in the missing parameters at ___
# simulate the the normal distribution wie set to sample size 30
help(rnorm)
my_data <- tibble(x1 = rnorm(30),
x2 = rnorm(30),
x3_noise = rnorm(30),
x4_noise = rnorm(30),
x5_noise = rnorm(30),
error = rnorm(30, sd = 3))
# Simulate data y with underlying population parameter \beta = (3, 1)
my_data <- my_data %>% mutate(y = x1*3 + x2*1 + error)
# Regress y on x1 and x2, without intercept
lm_small <- lm(y ~ x1 + x2 - 1, data = my_data)
# Have a look at the coefficients and summary statistics of the small model
lm_small %>% tidy()   # same as tidy(lm_small)
lm_small %>% glance() # same as glance(lm_small)
# Regress y on x1 and x2 and the noise variables, without intercept
lm_big <- lm(y ~ x1 + x2 + x3_noise + x4_noise + x5_noise - 1, data = my_data)
# Have a look at the coefficients and summary statistics of the small model
lm_big %>% tidy()
lm_big %>% glance()
# Use the multivariate normal distribution to generate 2 variables with 200 observations, generated from a multivariate normal distribution with unit variance an correlation -0.7
# Have a look at ?rmvnorm
?rmvnorm
# Use the multivariate normal distribution to generate 2 variables with 200 observations, generated from a multivariate normal distribution with unit variance an correlation -0.7
# Have a look at ?rmvnorm
help rmvnorm
# This exercise explores the effects of omitted variables
# Replace all instances of "???" to run the code
# Install and attach packages ####
rm(list = ls())
pkgs <- c("tidyverse",
"mvtnorm")
for (i in seq_along(pkgs)){
if (!requireNamespace(pkgs[i], quietly = TRUE)){
install.packages(pkgs[i])
}
}
library(tidyverse)
library(broom)
library(mvtnorm)
# __Set random seed such that the results are reproducible ####
set.seed(1985)
# Use the multivariate normal distribution to generate regressors
# Have a look at ?rmvnorm
?rmvnorm
# Use the multivariate normal distribution to generate regressors
# Have a look at ?rmvnorm
regressors_pos <- rmvnorm(200, sigma = matrix(c(1, 0.7, 0.7, 1), nrow = 2)) %>% as_tibble()
# Simulate the (in reality unobserved) errors and the left-hand-side variable y
# the true underlying population parameters are \beta = (\beta_1, \beta_2)' = (3,2) and \sigma^2 = 1.5^2
data_pos <- regressors_pos %>%
mutate(errors = rnorm(200, mean = 0, sd = 1.5)) %>%
mutate(y = V1*3 + V2*2 + errors)
# __Estimate different models ####
# ____Big model ####
# Estimate the model with the full set of regressors
lmp_big <- lm(y ~ V1 + V2 - 1, data = data_pos)
lmp_big %>% glance()
lmp_big %>% tidy()
# ____Small model ####
# Estimate the models when the second variable is omitted
lmp_small <- lm(y ~ V1 - 1, data = data_pos)
lmp_small %>% glance()
lmp_small %>% tidy()
# Negative correlation between regressors ####
# __Set random seed such that the results are reproducible ####
set.seed(1985)
# __Generate data ####
# Use the multivariate normal distribution to generate 2 variables with 200 observations, generated from a multivariate normal distribution with unit variance an correlation -0.7
# Have a look at ?rmvnorm
regressors_neg <- rmvnorm(200, sigma = matrix(c(1, -0.7, -0.7, 1), nrow = 2)) %>% as_tibble()
# Simulate the (in reality unobserved) errors and the left-hand-side variable y
# the true underlying population parameters are \beta = (\beta_1, \beta_2)' = (3,2) and \sigma^2 = 1.5^2
data_neg <- regressors_neg %>%
mutate(errors = rnorm(200, mean = 0, sd = 1.5)) %>%
mutate(y = V1*3 + V2*2 + errors)
# __Estimate different models ####
# ____Big model ####
lmn_big <- lm(y ~ V1 + V2 - 1, data = data_neg)
lmn_big %>% glance()
lmn_big %>% tidy()
# ____Small model ####
lmn_small <- lm(y ~ V1 - 1, data = data_neg)
lmn_small %>% glance()
lmn_small %>% tidy()
# This exercise explores the effects of omitted variables
# Replace all instances of "???" to run the code
# Install and attach packages ####
rm(list = ls())
pkgs <- c("tidyverse",
"mvtnorm")
for (i in seq_along(pkgs)){
if (!requireNamespace(pkgs[i], quietly = TRUE)){
install.packages(pkgs[i])
}
}
library(tidyverse)
library(broom)
library(mvtnorm)
# Positive correlation between regressors ####
# __Set random seed such that the results are reproducible ####
set.seed(1985)
# __Generate data ####
# Use the multivariate normal distribution to generate regressors
# Have a look at ?rmvnorm
regressors_pos <- rmvnorm(200, sigma = matrix(c(1, 0.7, 0.7, 1), nrow = 2)) %>% as_tibble()
# Simulate the (in reality unobserved) errors and the left-hand-side variable y
# the true underlying population parameters are \beta = (\beta_1, \beta_2)' = (3,2) and \sigma^2 = 1.5^2
data_pos <- regressors_pos %>%
mutate(errors = rnorm(200, mean = 0, sd = 1.5)) %>%
mutate(y = V1*3 + V2*2 + errors)
# __Estimate different models ####
# ____Big model ####
# Estimate the model with the full set of regressors
lmp_big <- lm(y ~ V1 + V2 - 1, data = data_pos)
lmp_big %>% glance()
lmp_big %>% tidy()
# ____Small model ####
# Estimate the models when the second variable is omitted
lmp_small <- lm(y ~ V1 - 1, data = data_pos)
lmp_small %>% glance()
lmp_small %>% tidy()
# Negative correlation between regressors ####
# __Set random seed such that the results are reproducible ####
set.seed(1985)
# __Generate data ####
# Use the multivariate normal distribution to generate 2 variables with 200 observations, generated from a multivariate normal distribution with unit variance an correlation -0.7
# Have a look at ?rmvnorm
regressors_neg <- rmvnorm(200, sigma = matrix(c(1, -0.7, -0.7, 1), nrow = 2)) %>% as_tibble()
# Simulate the (in reality unobserved) errors and the left-hand-side variable y
# the true underlying population parameters are \beta = (\beta_1, \beta_2)' = (3,2) and \sigma^2 = 1.5^2
data_neg <- regressors_neg %>%
mutate(errors = rnorm(200, mean = 0, sd = 1.5)) %>%
mutate(y = V1*3 + V2*2 + errors)
# __Estimate different models ####
# ____Big model ####
lmn_big <- lm(y ~ V1 + V2 - 1, data = data_neg)
lmn_big %>% glance()
lmn_big %>% tidy()
# ____Small model ####
lmn_small <- lm(y ~ V1 - 1, data = data_neg)
lmn_small %>% glance()
lmn_small %>% tidy()
v1 <- c(-1, 0, 1)
selection_vector <- v1 > 0
v1pos <- v1[selection_vector]
v1pos
v1 <- c(1, 2)
v2 <- c(3, 4)
v3 <- (v1, v2)
v3
v1 <- c(1, 2)
v2 <- c(3, 4)
v3 <- c(v1, v2)
v3
matrix1 <- matrix(1:4, byrow = T, nrow = 2)
ctitles <- c("a", "b")
rtitles <- c("c", "d")
# Name the columns with region
colnames(matrix1) <- ctitles
rownames(matrix1) <- rtitles
matrix1
v1 <- c(0, 1)
v2 <- c(0, 0)
matrix1 <- cbind(v1, v2)
matrix1
v1 <- c(0, 1)
v2 <- c(0, 0)
matrix1 <- rbind(v1, v2)
matrix1
v2 <- c(0, 0)
setwd("C:/Users/Teppo/Documents/GitHub/IODS-project/data")
alc <- read.csv("alc.csv", row.names = 1)
colnames(alc)
str(alc)
alc$activities <- as.numeric(alc$activities)
alc$Pstatus <- as.numeric(alc$Pstatus)
# Simple correlation coefficients
cor(alc$high_use, alc$Medu)
cor(alc$high_use, alc$studytime)
cor(alc$high_use, alc$activities)
cor(alc$high_use, alc$Pstatus)
# Installing relevant packages
library(dplyr)
library(ggplot2)
# Distributional plots
g1 <- ggplot(alc, aes(x = Medu))
g2 <- ggplot(alc, aes(x = studytime))
g3 <- ggplot(alc, aes(x = activities))
g4 <- ggplot(alc, aes(x = Pstatus))
g1 + geom_bar()
g2 + geom_bar()
g3 + geom_bar()
g4 + geom_bar()
# Cross tabulations
table(alc$high_use, alc$Medu)
table(alc$high_use, alc$studytime)
table(alc$high_use, alc$activities)
table(alc$high_use, alc$Pstatus)
m1 <- glm(high_use ~ Medu + studytime + activities + Pstatus, data = alc, family = binomial)
summary(m1)
exp(coef(m1))
exp(confint(m1))
probabilites <- predict(m1, type = "response")
table(high_use = alc$high_use, prediction = probabilities)
probabilities <- predict(m1, type = "response")
table(high_use = alc$high_use, prediction = probabilities)
alc <- mutate(alc, prediction = probability < 0.5)
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
table(high_use = alc$high_use, prediction = alc$prediction)
m2 <- glm(high_use ~ studytime, data = alc, family = binomial)
probabilities <- predict(m2, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
table(high_use = alc$high_use, prediction = alc$prediction)
summarise(alc$prediction)
summary(alc$prediction)
m2 <- glm(high_use ~ studytime, data = alc, family = "binomial")
probabilities <- predict(m2, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
table(high_use = alc$high_use, prediction = alc$prediction)
summary(alc$prediction)
head(alc$prediction)
head(alc$probability)
alc$probability
m2 <- glm(high_use ~ studytime + Medu + activities + Pstatus, data = alc, family = "binomial")
probabilities <- predict(m2, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
table(high_use = alc$high_use, prediction = alc$prediction)
summary(high_use)
summary(alc$high_use)
m3 <- glm(high_use ~ studytime + sex + absences, data = alc, family = binomial)
probabilities2 <- predict(m3, type = "response")
alc <- mutate(alc, probability2 = probabilities2)
alc <- mutate(alc, prediction2 = probability > 0.5)
table(high_use = alc$high_use, prediction = alc$prediction2)
m3 <- glm(high_use ~ studytime + sex + absences, data = alc, family = binomial)
probabilities2 <- predict(m3, type = "response")
alc <- mutate(alc, probability2 = probabilities2)
alc <- mutate(alc, prediction2 = probability2 > 0.5)
table(high_use = alc$high_use, prediction = alc$prediction2)
alc %>%
ggplot(aes(x = probability, y = high_use, col = prediction)) +
geom_point()
table(high_use = alc$high_use, prediction = alc$prediction) %>%
prop.table() %>%
add.margins() %>%
table(high_use = alc$high_use, prediction = alc$prediction) %>%
prop.table() %>%
add.margins()
# Installing relevant packages
library(dplyr)
library(ggplot2)
table(high_use = alc$high_use, prediction = alc$prediction) %>%
prop.table() %>%
add.margins()
table(high_use = alc$high_use, prediction = alc$prediction) %>%
prop.table() %>%
addmargins()
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = 0)
table(high_use = alc$high_use, prediction = alc$prediction) %>%
prop.table() %>%
addmargins()
m3 <- glm(high_use ~ studytime + sex + absences, data = alc, family = binomial)
probabilities2 <- predict(m3, type = "response")
alc <- mutate(alc, probability2 = probabilities2)
alc <- mutate(alc, prediction2 = probability2 > 0.5)
table(high_use = alc$high_use, prediction = alc$prediction2)
table(high_use = alc$high_use, prediction = alc$prediction) %>%
prop.table() %>%
addmargins()
alc %>%
ggplot(aes(x = probability, y = high_use, col = prediction)) +
geom_point()
a <- matrix(2 -3 1; 2 4 1)
a <- matrix(2, -3, 1, 2, 4, 1, nrow = 2)
a <- matrix(2, -3, 1, 2, 4, 1, nrow = 2, ncol = 3)
a <- matrix(c(2, -3, 1, 2, 4, 1), nrow = 2, ncol = 3)
a
a <- matrix(c(2, 2, -3, 4, 1, 1), nrow = 2, ncol = 3)
a
solve(a)
a <- cbind(c(2, -3), c(2, 4))
a
a <- rbind(c(2, -3), c(2, 4))
a
b <- rbind(c(1/12, 0), c(1/12, 0))
c <- rbind(c(2, 2) c(-3, 4))
c <- rbind(c(2, 2), c(-3, 4))
a%*%b%*%c
a
source('~/.active-rstudio-document', echo=TRUE)
b
b <- rbind(c(1/12, 0), c(0, 1/12))
b
a%*%b%*%c
b
a%*%b%*%c
a <- rbind(c(2, -3), c(2, 4))
b <- rbind(c(1/12, 0), c(0, 1/12))
c <- rbind(c(2, 2), c(-3, 4))
a%*%b%*%c
library(data.table)
setwd("C:/Users/Teppo/Documents/GitHub/IODS-project/data")
human <- fread("human.csv", header = T, drop = 1)
arrange(human)
library(dplyr)
arrange(human)
arrange(human, hdirank)
arrange(human, giirank)
str(human)
human %>%
mutate(gni = str_replace(gni, ",", "."))
##########################################################################################
# Q1. Mutating data
library(stringr)
human %>%
mutate(gni = str_replace(gni, ",", "."))
human <- human %>%
mutate(gni = str_replace(gni, ",", "."))
str(human)
human <- fread("human.csv", header = T, drop = 1)
head(human$gni)
str(human)
human <- human %>%
mutate(gni = str_replace(gni, ",", ""))
str(human)
human <- human %>%
mutate(gni = str_replace(gni, ",", ""))
mutate(gni = as.numeric(gni))
human <- fread("human.csv", header = T, drop = 1)
human <- human %>%
mutate(gni = str_replace(gni, ",", "")) %>%
mutate(gni = as.numeric(gni))
str(human)
keep <- c("country", "eduratio", "prateratio", "eduexp", "lifeexp", "gni",
"mmor", "adobirth", "frep")
human <- human %>%
filter(one_of(keep))
str(human)
human <- human %>%
select(one_of(keep))
human <- fread("human.csv", header = T, drop = 1)
human <- human %>%
mutate(gni = str_replace(gni, ",", "")) %>%
mutate(gni = as.numeric(gni))
keep <- c("country", "eduratio", "prateratio", "eduexp", "lifexp", "gni",
"mmor", "adobirth", "frep")
human <- human %>%
select(one_of(keep))
str(human)
human <- human %>%
filter(complete.cases(human))
str(human)
human <- fread("human.csv", header = T, drop = 1)
human <- human %>%
mutate(gni = str_replace(gni, ",", "")) %>%
mutate(gni = as.numeric(gni))
keep <- c("country", "eduratio", "prateratio", "eduexp", "lifexp", "gni",
"mmor", "adobirth", "frep")
human <- human %>%
select(one_of(keep))
str(human)
##########################################################################################
# Q2. Removing missing values
count(is.na(human))
human <- human %>%
filter(complete.cases(human))
str(human)
human$country
##########################################################################################
# Q4. Excluding regions
last <- nrow(human) - 7
human <- human %>%
filter(human[1:last,])
human <- filter(human[1:last,])
str(human)
rownames(human) <- human$country
str(human)
rownames(human) <- human$country
str(human)
human <- human %>%
select(human, -country)
human <- human %>%
select(human, -country)
last <- nrow(human) - 7
human <- filter(human[1:last,])
str(human)
human <- fread("human.csv", header = T, drop = 1)
str(human)
dim(human)
head(human$gni)
# The dataset I am working with consists of 195 observations and 19 variables.
# The observations are countries, and the variables are various indicators
# of economic and social development. Apart from self-evident cases, a
# variable description is provided below:
# hdirank = country's rank according to the human development index
# lifeexp = life expectancy at birth
# eduexp = expected years of education
# edu = mean years of education
# diffrank = rank in gni per capita minus rank in hdi
# giirank = country's rank according to the gender inequality index
# mmor = maternal mortality ratio
# adobirth = adolescent birth rate
# frep = female representation in parliament
# f2edu = proportion of secondary education, female
# m2edu = proportion of secondary education, male
# fprate = labour force participation rate, female
# mprate = labour force participation rate, male
# eduratio = f2edu / m2edu
# prateratio = fprate / mprate
##########################################################################################
# Q1. Mutating data
library(stringr)
human <- human %>%
mutate(gni = str_replace(gni, ",", "")) %>%
mutate(gni = as.numeric(gni))
str(human)
##########################################################################################
# Q2. Mutating data
keep <- c("country", "eduratio", "prateratio", "eduexp", "lifexp", "gni",
"mmor", "adobirth", "frep")
human <- human %>%
select(one_of(keep))
str(human)
##########################################################################################
# Q3. Removing missing values
human <- human %>%
filter(complete.cases(human))
str(human)
##########################################################################################
# Q4. Excluding regions
last <- nrow(human) - 7
human <- human[1:last,]
str(human)
rownames(human) <- human$country
str(human)
human <- human %>%
select(-country)
str(human)
?write.csv
write.csv(human, "human2.csv", row.names = T)
str(human)
library(GGally)
human <- fread("human2.csv")
setwd("C:/Users/Teppo/Documents/GitHub/IODS-project/data")
human <- fread("human2.csv")
human <- fread("human2.csv")
setwd("~/GitHub/IODS-project/data")
human <- fread("human2.csv")
human <- fread("human2.csv")
setwd("C:/Users/Teppo/Documents/GitHub/IODS-project/data")
human <- fread("human2.csv")
human <- fread("human2.csv", header = T)
human <- fread("human.csv")
human <- fread("human.csv", row.names = 1)
human <- read.csv("human.csv", row.names = 1)
human <- read.csv("human2.csv", row.names = 1)
setwd("C:/Users/Teppo/Documents/GitHub/IODS-project/data")
human <- read.csv("human2.csv", row.names = 1)
human <- read.csv("C:/Users/Teppo/Documents/GitHub/IODS-project/data/human2.csv", row.names = 1)
ggpairs(human)
ggpairs(human)
summary(human)
dim(human)
